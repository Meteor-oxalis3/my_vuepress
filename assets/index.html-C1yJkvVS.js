import{_ as o,c as g,b as i,d as a,e as n,a as k,f as t,r as d,o as A}from"./app-ChR0t5KL.js";const y="/assets/ATAC_seq_Data-GOdraREB.png",u="/assets/footprinting-BTnFUuJW.png",m={},D={id:"基于snakemake-的-atac-seq-足迹识别与差异分析流程开发及应用-以-hcv-相关肝癌为例",tabindex:"-1"},C={class:"header-anchor",href:"#基于snakemake-的-atac-seq-足迹识别与差异分析流程开发及应用-以-hcv-相关肝癌为例"},b={class:"vp-file-tree"},v={class:"tree-node folder"},B={class:"tree-node folder"},f={class:"tree-node folder"},c={class:"tree-node folder"},E={class:"tree-node folder"},q={class:"tree-node folder"},x={class:"tree-node folder"},_={class:"tree-node folder"},H={class:"tree-node folder"},R={class:"tree-node file"},S={class:"tree-node file"},T={class:"tree-node file"},w={class:"tree-node file"},z={class:"tree-node file"},M={class:"tree-node file"},F={class:"tree-node file"},P={class:"tree-node file"},N={class:"tree-node file"},O={class:"tree-node file"},G={class:"tree-node file"},I={class:"tree-node folder"},j={class:"tree-node file"},V={class:"tree-node file"},X={class:"tree-node file"},$={class:"tree-node file"},W={class:"tree-node file"},L={class:"tree-node folder"},U={class:"tree-node folder"},J={class:"tree-node folder"},K={class:"tree-node folder"},Q={class:"tree-node folder"},Y={class:"tree-node folder"},Z={class:"tree-node file"},ss={class:"tree-node file"},is={class:"tree-node folder"},as={class:"tree-node file"},ns={class:"tree-node folder"},ls={class:"tree-node file"},es={class:"tree-node file"},ts={class:"tree-node file"},ps={class:"tree-node file"},ks={class:"tree-node file"},ds={class:"tree-node folder"},hs={class:"tree-node folder"},rs={class:"tree-node folder"};function os(gs,s){const p=d("Icon"),h=d("RepoCard"),r=d("PDFViewer"),l=d("VPIcon"),e=d("FileTreeItem");return A(),g("div",null,[s[255]||(s[255]=i("p",null,"2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组",-1)),s[256]||(s[256]=i("hr",null,null,-1)),i("h1",D,[i("a",C,[i("span",null,[s[0]||(s[0]=a("基于")),n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[1]||(s[1]=a("Snakemake 的 ATAC-seq 足迹识别与差异分析流程开发及应用：以 HCV 相关肝癌为例"))])])]),s[257]||(s[257]=k('<h2 id="_1-前言" tabindex="-1"><a class="header-anchor" href="#_1-前言"><span>1. 前言</span></a></h2><h3 id="_1-1-背景" tabindex="-1"><a class="header-anchor" href="#_1-1-背景"><span>1.1 背景</span></a></h3><ul><li><p>慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者，其中 10-20% 的患者在其一生中可能出现严重的肝脏并发症。表观遗传机制 ( 如 DNA 甲基化和组蛋白修饰 ) 在多种疾病过程中，尤其是肝病的发生和发展中，发挥了关键作用。HCV 感染能够显著改变这些表观遗传标记，并可能在感染治愈后留下 “表观遗传疤痕” ，从而导致长期的基因调控异常和癌症风险。</p></li><li><p>近年来，直接作用抗病毒药物 ( DAA ) 的发展为 HCV 的治愈提供了新的希望。然而，临床观察表明，即使在达到持续病毒学应答( SVR ) 后，患者的 HCC 风险仍未完全消除。这提示 HCV 感染可能通过持久的表观遗传损伤影响肝脏细胞功能，为理解这些过程的分子机制提供了研究必要性。</p></li></ul><h3 id="_1-2-目标" tabindex="-1"><a class="header-anchor" href="#_1-2-目标"><span>1.2 目标</span></a></h3>',4)),i("ul",null,[i("li",null,[i("p",null,[s[2]||(s[2]=a("​为了揭示 HCV 感染如何通过表观遗传途径影响肝细胞功能，以及在病毒清除后这些改变是否仍然持续，本研究构建了基于")),n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[3]||(s[3]=a("Snakemake 的 ATAC-seq 足迹分析与差异分析流程，对相关数据进行系统性分析。具体目标包括："))]),s[4]||(s[4]=i("ol",null,[i("li",null,"构建高效、可重复的 Snakemake 流程，用于 ATAC-seq 数据的标准化处理、足迹识别和差异分析"),i("li",null,"比较 HCV 感染前后肝细胞系 ( Huh7.5 和 Hu1545 ) 染色质开放性和转录调控的变化"),i("li",null,"评估 HCV 治愈后，表观遗传标记的改变是否能够恢复正常"),i("li",null,"阐明 HCV 感染和治愈过程中关键基因失调的分子机制，为治疗策略优化提供数据支持")],-1))])]),s[258]||(s[258]=i("h2",{id:"_2-相关网址",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_2-相关网址"},[i("span",null,"2. 相关网址")])],-1)),i("ul",null,[i("li",null,[i("p",null,[s[5]||(s[5]=a("代码仓库：")),n(p,{name:"octicon:mark-github-16",size:"2em"}),s[6]||(s[6]=a()),s[7]||(s[7]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/",target:"_blank",rel:"noopener noreferrer"},"Meteor-oxalis3 / myATAC-seq",-1))]),n(h,{repo:"Meteor-oxalis3/myATAC-seq"})])]),s[259]||(s[259]=k('<h2 id="_3-数据来源" tabindex="-1"><a class="header-anchor" href="#_3-数据来源"><span>3. 数据来源</span></a></h2><ul><li>GEO：<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE168178" target="_blank" rel="noopener noreferrer">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE168178</a></li><li>对应文献：<a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC9416882/" target="_blank" rel="noopener noreferrer">https://pmc.ncbi.nlm.nih.gov/articles/PMC9416882/</a></li></ul><blockquote><p>Hu1545 was derived from primary human hepatocytes from a de-identified donor without liver disease. Huh7.5 is a derivative of the Huh7 HCC cell line with a RIG-I mutation that leaves the cell line more susceptible to HCV infection</p></blockquote><p><img src="'+y+'" alt="ATAC_seq_Data"></p><h2 id="_4-环境工具" tabindex="-1"><a class="header-anchor" href="#_4-环境工具"><span>4. 环境工具</span></a></h2><ul><li>流程语言：<a href="https://snakemake.readthedocs.io/" target="_blank" rel="noopener noreferrer">Snakemake v8.25.5</a></li><li>软件包管理：<a href="https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html" target="_blank" rel="noopener noreferrer">Micromamba v2.0.4</a></li><li>环境打包分发：<a href="https://docs.sylabs.io/guides/3.8/user-guide/" target="_blank" rel="noopener noreferrer">Singularity v3.8.6</a></li></ul><h2 id="_5-准备工作" tabindex="-1"><a class="header-anchor" href="#_5-准备工作"><span>5. 准备工作</span></a></h2><h3 id="_5-1-数据准备" tabindex="-1"><a class="header-anchor" href="#_5-1-数据准备"><span>5.1 数据准备</span></a></h3>',8)),i("ul",null,[i("li",null,[i("p",null,[s[8]||(s[8]=a("考虑到国内下载 SRA 的速度太慢，我在“赛博活菩萨”—— ")),n(p,{name:"devicon:cloudflare",size:"2em"}),s[9]||(s[9]=a("Cloudflare 那里搭建了一个镜像网站用于加速下载。还编写了一个 shell 小脚本 ( ")),s[10]||(s[10]=i("code",null,"cf-sra-get.sh",-1)),s[11]||(s[11]=a(" ) 进一步方便下载数据。"))]),s[12]||(s[12]=k(`<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 检查是否提供了参数</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -z</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> then</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Usage: $0 &lt;SRR_ID&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    exit</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 获取传入的SRR编号</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">SRR_ID</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">$1</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">SRA_NAME</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$SRR_ID.sra</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 下载文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -LS</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://sra.meteor-oxalis3.com/sra/$SRR_ID/$SRR_ID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $SRA_NAME</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))]),s[13]||(s[13]=k(`<li><p>开始下载数据：</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +x</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cf-sra-get.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849295</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849301</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849307</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849313</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>我定义的样本名称与对应的SRR号：</p><table><thead><tr><th style="text-align:center;">样本名称</th><th style="text-align:center;">SRR号</th><th style="text-align:left;">细胞类型</th></tr></thead><tbody><tr><td style="text-align:center;">Healthy1</td><td style="text-align:center;"><code>SRR13849295</code></td><td style="text-align:left;">Hu1545_ATAC</td></tr><tr><td style="text-align:center;">Healthy2</td><td style="text-align:center;"><code>SRR13849301</code></td><td style="text-align:left;">Hu1545_HCV_ATAC</td></tr><tr><td style="text-align:center;">HCC1</td><td style="text-align:center;"><code>SRR13849307</code></td><td style="text-align:left;">Huh7.5_ATAC</td></tr><tr><td style="text-align:center;">HCC2</td><td style="text-align:center;"><code>SRR13849313</code></td><td style="text-align:left;">Huh7.5_HCV_ATAC</td></tr></tbody></table></li><li><p>接下来我使用 <code>fasterq-dump</code> + <code>pigz</code> 的组合进行 <code>.sra</code> 转 <code>.fastq.gz</code>，比 <code>fastq-dump --gzip</code> 快不少 。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fasterq-dump</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -e</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --split-files</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.sra</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pigz</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> *</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.fastq</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mv</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> *</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.fastq.gz</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,3))]),s[260]||(s[260]=i("hr",null,null,-1)),s[261]||(s[261]=i("h3",{id:"_5-2-环境配置",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_5-2-环境配置"},[i("span",null,"5.2 环境配置")])],-1)),i("ul",null,[s[51]||(s[51]=k("<li><p>我采用了 <code>micromamba</code> 与 <code>singularity</code> 相结合的方案进行软件版本控制与分发：通过定义 <code>ATAC_seq_pipeline.def</code> 文件，在 <code>debian:bookworm-slim</code> 基础镜像中调用 <code>miccromamba</code> ，使用 <code>env_ATAC_seq.yml</code> 与 <code>env_idr.yml</code> 文件自动化构建 <code>myATAC-seq.sif</code> 镜像。</p></li>",1)),i("li",null,[i("p",null,[s[14]||(s[14]=a("当然，也可以使用 ")),n(p,{name:"vscode-icons:file-type-conda",size:"2em"}),s[15]||(s[15]=a()),s[16]||(s[16]=i("code",null,"conda",-1)),s[17]||(s[17]=a(" 或者 ")),s[18]||(s[18]=i("code",null,"micromamba",-1)),s[19]||(s[19]=a(" 直接构建虚拟环境。"))])]),i("li",null,[i("p",null,[s[20]||(s[20]=a("相关文件网址：")),n(p,{name:"octicon:mark-github-16",size:"2em"}),s[21]||(s[21]=a()),s[22]||(s[22]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/tree/main/singularity",target:"_blank",rel:"noopener noreferrer"},"Meteor-oxalis3 / myATAC-seq · singularity",-1))])]),i("li",null,[i("p",null,[s[23]||(s[23]=a("这里我在我的 ")),n(p,{name:"devicon:fedora",size:"2em"}),s[24]||(s[24]=a()),s[25]||(s[25]=i("code",null,"Fedora 41",-1)),s[26]||(s[26]=a(" 笔记本上构建好 ")),s[27]||(s[27]=i("code",null,"singularity",-1)),s[28]||(s[28]=a(" 镜像，再通过 ")),s[29]||(s[29]=i("code",null,"sftp",-1)),s[30]||(s[30]=a(" 传输到 ")),s[31]||(s[31]=i("code",null,".9",-1)),s[32]||(s[32]=a(" 服务器进行后续的数据处理。"))]),s[33]||(s[33]=k(`<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 首先克隆我的代码仓库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> clone</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> git@github.com:Meteor-oxalis3/myATAC-seq.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 接着进入 singularity 的 .def 文件所在的文件夹</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myATAC-seq/singularity</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开始构建 .sif 镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">singularity</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> build</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --fakeroot</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myATAC-seq.sif</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ATAC_seq_pipeline.def</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))]),i("li",null,[i("p",null,[s[34]||(s[34]=a("根据我之前折腾 ")),n(p,{name:"devicon:docker",size:"2em"}),s[35]||(s[35]=a()),s[36]||(s[36]=i("code",null,"docker",-1)),s[37]||(s[37]=a(" 和 ")),s[38]||(s[38]=i("code",null,"singularity",-1)),s[39]||(s[39]=a(" 的经验，软链接相应文件后，挂载自己 ")),s[40]||(s[40]=i("code",null,"$HOME",-1)),s[41]||(s[41]=a(" 路径之外的数据可以直接挂载所在用户的家目录，无需在自己的 ")),s[42]||(s[42]=i("code",null,"$HOME",-1)),s[43]||(s[43]=a(" 路径新建同名文件夹。"))])]),s[52]||(s[52]=k(`<li><p>借用一下邵老师已经下载好的相关数据，嘻嘻。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/data</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/BWA_Index/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/ENCODE/blacklist.v2/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/MEME/motif_databases/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/Ensembl/Homo_sapiens.GRCh38.100.chr.gtf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,1)),i("li",null,[i("p",null,[s[44]||(s[44]=a("流程运行时间较长，所以我在 ")),n(p,{name:"vscode-icons:file-type-light-tmux",size:"2em"}),s[45]||(s[45]=a()),s[46]||(s[46]=i("code",null,"tmux",-1)),s[47]||(s[47]=a(" 里面运行 ")),s[48]||(s[48]=i("code",null,"singularity",-1)),s[49]||(s[49]=a(" 。"))]),s[50]||(s[50]=k(`<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tmux</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">myATAC-seq</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/pre_and_peakcalling</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/pre_and_peakcalling</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">singularity</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shell</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --bind</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf:/public/workspace/shaojf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../singularity/myATAC-seq.sif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))])]),s[262]||(s[262]=i("h2",{id:"_6-数据预处理-peak-calling",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-数据预处理-peak-calling"},[i("span",null,"6. 数据预处理 + Peak Calling")])],-1)),i("ul",null,[i("li",null,[i("p",null,[s[53]||(s[53]=a("参考这篇文献")),s[54]||(s[54]=i("sup",{class:"footnote-ref"},[i("a",{href:"#footnote1"},"[1]"),i("a",{class:"footnote-anchor",id:"footnote-ref1"})],-1)),s[55]||(s[55]=a("推荐的预处理步骤，我使用 ")),n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[56]||(s[56]=a()),s[57]||(s[57]=i("code",null,"snakemake",-1)),s[58]||(s[58]=a(" 编写了一个流程，实现了从 ATAC-Seq 双末端测序的原始数据到 Peak Calling 的完整过程。"))]),s[59]||(s[59]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/pre.png",style:{zoom:"16%"}})],-1))])]),s[263]||(s[263]=i("h3",{id:"_6-1-代码",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-代码"},[i("span",null,"6.1 代码")])],-1)),i("ul",null,[i("li",null,[s[60]||(s[60]=a("在 ")),s[61]||(s[61]=i("code",null,"singularity",-1)),s[62]||(s[62]=a(" 里面直接调用 ")),n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[63]||(s[63]=k(` <code>snakemake</code> 流程。 <ul><li><p>HCC1</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849307_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849307_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>HCC2</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849313_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849313_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Healthy1</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849295_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849295_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Healthy2</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849301_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849301_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul>`,4))])]),s[264]||(s[264]=i("h4",{id:"_6-1-1-数据链接",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-1-数据链接"},[i("span",null,"6.1.1 数据链接")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[64]||(s[64]=a()),s[65]||(s[65]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/link.smk",target:"_blank",rel:"noopener noreferrer"},'"link.smk"',-1)),s[66]||(s[66]=i("p",null,[a("将原始 "),i("code",null,"fastq.gz"),a(" 数据文件软链接到特定文件夹，方便后续调用。")],-1))])]),s[265]||(s[265]=i("h4",{id:"_6-1-2-第一次质检",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-2-第一次质检"},[i("span",null,"6.1.2 第一次质检")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[67]||(s[67]=a()),s[68]||(s[68]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/fastqc_raw.smk",target:"_blank",rel:"noopener noreferrer"},'"fastqc_raw.smk"​',-1)),s[69]||(s[69]=i("p",null,[a("使用 "),i("code",null,"fastqc"),a(" 对原始下机数据进行第一次质量检查。")],-1))])]),s[266]||(s[266]=i("h4",{id:"_6-1-3-接头剪切",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-3-接头剪切"},[i("span",null,"6.1.3 接头剪切")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[70]||(s[70]=a()),s[71]||(s[71]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/fastp.smk",target:"_blank",rel:"noopener noreferrer"},'"fastp.smk"',-1)),s[72]||(s[72]=i("p",null,[a("使用 "),i("code",null,"fastp"),a(" 的双末端模式自动识别接头类型并进行剪切。")],-1))])]),s[267]||(s[267]=i("h4",{id:"_6-1-4-第二次质检",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-4-第二次质检"},[i("span",null,"6.1.4 第二次质检")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[73]||(s[73]=a()),s[74]||(s[74]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/fastqc_trimmed.smk",target:"_blank",rel:"noopener noreferrer"},'"fastqc_trimmed.smk"​',-1)),s[75]||(s[75]=i("p",null,[a("使用 "),i("code",null,"fastqc"),a(" 对剪切接头后的数据进行第二次质量检查。")],-1))])]),s[268]||(s[268]=i("h4",{id:"_6-1-5-序列比对",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-5-序列比对"},[i("span",null,"6.1.5 序列比对")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[76]||(s[76]=a()),s[77]||(s[77]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/bwa.smk",target:"_blank",rel:"noopener noreferrer"},'"bwa.smk"',-1)),s[78]||(s[78]=i("p",null,[a("使用 "),i("code",null,"bwa"),a(" 进行序列比对到参考基因组，生成 "),i("code",null,".sam"),a(" 文件。")],-1))])]),s[269]||(s[269]=i("h4",{id:"_6-1-6-samtools-系列处理",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-6-samtools-系列处理"},[i("span",null,"6.1.6 samtools 系列处理")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[79]||(s[79]=a()),s[80]||(s[80]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/samtools.smk",target:"_blank",rel:"noopener noreferrer"},'"samtools.smk"',-1)),s[81]||(s[81]=i("p",null,[a("使用 "),i("code",null,"samtools"),a(" 对输入文件执行统计、格式转换、修复配对、排序、去重和索引等标准化处理步骤。")],-1))])]),s[270]||(s[270]=i("h4",{id:"_6-1-7-偏移修正",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-7-偏移修正"},[i("span",null,"6.1.7 偏移修正")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[82]||(s[82]=a()),s[83]||(s[83]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/alignmentSieve.smk",target:"_blank",rel:"noopener noreferrer"},'"alignmentSieve.smk"',-1)),s[84]||(s[84]=i("p",null,[a("使用 "),i("code",null,"deeptools"),a(" 里面的 "),i("code",null,"alignmentSieve"),a(" 工具过滤和调整测序比对数据，并且使用 "),i("code",null,"samtools"),a(" 按照参考基因组的位置进行排序，方便后续的 "),i("code",null,"Diffbind"),a(" 差异分析。")],-1))])]),s[271]||(s[271]=i("h4",{id:"_6-1-8-peak-calling",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-8-peak-calling"},[i("span",null,"6.1.8 Peak Calling")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[85]||(s[85]=a()),s[86]||(s[86]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/macs3.smk",target:"_blank",rel:"noopener noreferrer"},'"macs3.smk"',-1)),s[87]||(s[87]=i("p",null,[a("使用 "),i("code",null,"MACS3"),a(" 检测 peaks。")],-1))])]),s[272]||(s[272]=i("h4",{id:"_6-1-9-汇总预处理结果",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_6-1-9-汇总预处理结果"},[i("span",null,"6.1.9 汇总预处理结果")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[88]||(s[88]=a()),s[89]||(s[89]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/pre_and_peakcalling/rules/multiqc.smk",target:"_blank",rel:"noopener noreferrer"},'"multiqc.smk"',-1)),s[90]||(s[90]=i("p",null,[a("使用 "),i("code",null,"multiqc"),a(" 将接头剪切和序列比对的结果进行汇总报告。")],-1))])]),s[273]||(s[273]=i("h2",{id:"_7-足迹识别",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-足迹识别"},[i("span",null,"7. 足迹识别")])],-1)),i("ul",null,[i("li",null,[s[91]||(s[91]=a("这里我参考了 ")),s[92]||(s[92]=i("code",null,"TOBIAS",-1)),s[93]||(s[93]=a(" 官方")),s[94]||(s[94]=i("sup",{class:"footnote-ref"},[i("a",{href:"#footnote2"},"[2]"),i("a",{class:"footnote-anchor",id:"footnote-ref2"})],-1)),s[95]||(s[95]=a("提供的流程图，自己编写了从上个流程的 4 个样本结果到 ")),s[96]||(s[96]=i("code",null,"BINDetect",-1)),s[97]||(s[97]=a(" 步骤的 ")),n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[98]||(s[98]=a()),s[99]||(s[99]=i("code",null,"snakemake",-1)),s[100]||(s[100]=a(" 流程。 ")),s[101]||(s[101]=i("div",{style:{"text-align":"center"}},[i("br"),i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/snakemake_workflow.png"}),i("br"),i("br"),i("img",{src:u,style:{zoom:"16%"}})],-1))])]),s[274]||(s[274]=k(`<h3 id="_7-1-代码" tabindex="-1"><a class="header-anchor" href="#_7-1-代码"><span>7.1 代码</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/bindetect/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">case_prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> control_prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">20</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">case1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/HCC1/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">case2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/HCC2/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/Healthy1/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/Healthy2/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">motifs=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/motif_databases/JASPAR/JASPAR2022_CORE_vertebrates_non-redundant_v2.meme</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-1-1-合并-bam" tabindex="-1"><a class="header-anchor" href="#_7-1-1-合并-bam"><span>7.1.1 合并 BAM</span></a></h4>`,3)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[102]||(s[102]=a()),s[103]||(s[103]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/samtools_merge_case.smk",target:"_blank",rel:"noopener noreferrer"},'"samtools_merge_case.smk"',-1)),s[104]||(s[104]=a(", ")),s[105]||(s[105]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/samtools_merge_control.smk",target:"_blank",rel:"noopener noreferrer"},'"samtools_merge_control.smk"',-1)),s[106]||(s[106]=i("p",null,[a("由于 "),i("code",null,"TOBIAS"),a(" 不支持生物学重复，所以需要将各组的 bam 文件合并一下。")],-1))])]),s[275]||(s[275]=i("h4",{id:"_7-1-2-idr-分析",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-1-2-idr-分析"},[i("span",null,"7.1.2 IDR 分析")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[107]||(s[107]=a()),s[108]||(s[108]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/idr_case.smk",target:"_blank",rel:"noopener noreferrer"},'"idr_case.smk"',-1)),s[109]||(s[109]=a(", ")),s[110]||(s[110]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/idr_control.smk",target:"_blank",rel:"noopener noreferrer"},'"idr_control.smk"',-1)),s[111]||(s[111]=i("p",null,[a("使用 "),i("code",null,"IDR"),a(" 进行 Peak 过滤和筛选，接着使用 "),i("code",null,"awk"),a(" 将通过 IDR 阈值的 Peak 提取后转换为 narrowPeak 格式。")],-1))])]),s[276]||(s[276]=i("h4",{id:"_7-1-3-合并生成多样本共识-peaks",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-1-3-合并生成多样本共识-peaks"},[i("span",null,"7.1.3 合并生成多样本共识 Peaks")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[112]||(s[112]=a()),s[113]||(s[113]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/bedtools_merge.smk",target:"_blank",rel:"noopener noreferrer"},'"bedtools_merge.smk"',-1)),s[114]||(s[114]=i("p",null,[a("合并 "),i("code",null,"case"),a(" 组和 "),i("code",null,"control"),a(" 组的 IDR 结果，并通过 "),i("code",null,"bedtools"),a(" 对合并后的峰值进行排序和筛选，最后去除线粒体 DNA。")],-1))])]),s[277]||(s[277]=i("h4",{id:"_7-1-4-atacorrect-矫正",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-1-4-atacorrect-矫正"},[i("span",null,"7.1.4 ATACorrect 矫正")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[115]||(s[115]=a()),s[116]||(s[116]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/tobias_ATACorrect_case.smk",target:"_blank",rel:"noopener noreferrer"},'"tobias_ATACorrect_case.smk"',-1)),s[117]||(s[117]=a(", ")),s[118]||(s[118]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/tobias_ATACorrect_control.smk",target:"_blank",rel:"noopener noreferrer"},'"tobias_ATACorrect_control.smk"',-1)),s[119]||(s[119]=i("p",null,[a("使用 "),i("code",null,"TOBIAS"),a(" 对 "),i("code",null,"case"),a(" 组和 "),i("code",null,"control"),a(" 组的 BAM 文件和合并的 Peaks 进行 ATAC-seq 偏倚校正 Tn5 转座酶矫正。")],-1))])]),s[278]||(s[278]=i("h4",{id:"_7-1-5-scorebigwig-足迹计算",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-1-5-scorebigwig-足迹计算"},[i("span",null,"7.1.5 ScoreBigwig 足迹计算")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[120]||(s[120]=a(' "tobias_ScoreBigwig_case.smk", "tobias_ScoreBigwig_control.smk"')),s[121]||(s[121]=i("p",null,[a("使用 "),i("code",null,"TOBIAS"),a(" 根据校正后的信号文件和合并的 Peaks 计算足迹。")],-1))])]),s[279]||(s[279]=i("h4",{id:"_7-1-6-bindetect-分析",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-1-6-bindetect-分析"},[i("span",null,"7.1.6 BINDetect 分析")])],-1)),i("ul",null,[i("li",null,[n(p,{name:"vscode-icons:file-type-snakemake",size:"2em"}),s[129]||(s[129]=a()),s[130]||(s[130]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/blob/main/snakemake/bindetect/rules/tobias_BINDetect.smk",target:"_blank",rel:"noopener noreferrer"},'"tobias_BINDetect.smk"',-1)),s[131]||(s[131]=i("p",null,[a("使用 "),i("code",null,"TOBIAS"),a(" 在 "),i("code",null,"case"),a(" 组和 "),i("code",null,"control"),a(" 组的足迹信号文件上进行 "),i("code",null,"BINDetect"),a(" 分析：首先在所有开发区域搜索已知的 motif 基序，确定可能的结合位点，再结合足迹分数，推测是否可能有 TF 结合。")],-1)),i("ul",null,[i("li",null,[s[128]||(s[128]=a("详细结果文件: ")),i("ol",null,[i("li",null,[s[122]||(s[122]=a("表格：")),n(p,{name:"vscode-icons:file-type-excel",size:"2em"}),s[123]||(s[123]=i("a",{href:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/bindetect_results.xlsx",target:"_blank",rel:"noopener noreferrer"},[i("code",null,"~/myATAC-seq/bindetect/footprinting/bindetect_results.xlsx")],-1))]),i("li",null,[s[124]||(s[124]=a("交互式网页：")),n(p,{name:"vscode-icons:file-type-html",size:"2em"}),s[125]||(s[125]=i("a",{href:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/bindetect_HCC_Healthy.html",target:"_blank",rel:"noopener noreferrer"},[i("code",null,"~/myATAC-seq/bindetect/footprinting/bindetect_HCC_Healthy.html")],-1)),s[126]||(s[126]=a()),s[127]||(s[127]=i("div",{style:{"text-align":"center"}},[i("br"),i("iframe",{style:{border:"none"},width:"100%",height:"630px",src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/bindetect_HCC_Healthy.html"})],-1))])])])])])]),s[280]||(s[280]=i("hr",null,null,-1)),s[281]||(s[281]=i("h3",{id:"_7-2-单个-motif-分析",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-2-单个-motif-分析"},[i("span",null,"7.2 单个 motif 分析")])],-1)),i("ul",null,[i("li",null,[s[153]||(s[153]=i("p",null,"这里我以 FOXA1 为例，进行单个 motif 分析，直观展示不同条件下的足迹可视化图谱。",-1)),s[154]||(s[154]=i("h4",{id:"_7-2-1-聚合信号曲线图",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-2-1-聚合信号曲线图"},[i("span",null,"7.2.1 聚合信号曲线图")])],-1)),i("ul",null,[i("li",null,[s[132]||(s[132]=k(`<p>使用 <code>TOBIAS PlotAggregate</code> 绘制。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect/motif</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect/motif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotAggregate</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_unbound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HHealthy_unbound</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signals </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../HCC/tobias/HCC_uncorrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_uncorrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signal-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_uncorrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_uncorrected</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--output </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">FOXA1_MA0148.4_PlotAggregate.pdf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--plot-boundaries</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[133]||(s[133]=a()),s[134]||(s[134]=i("strong",null,"FOXA1_MA0148.4_PlotAggregate.pdf",-1)),s[135]||(s[135]=a()),s[136]||(s[136]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/FOXA1_MA0148.4_PlotAggregate.png",style:{zoom:"10%"}})],-1))])]),s[155]||(s[155]=i("h4",{id:"_7-2-2-热图",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-2-2-热图"},[i("span",null,"7.2.2 热图")])],-1)),i("ul",null,[i("li",null,[s[137]||(s[137]=k(`<p>使用 <code>TOBIAS PlotHeatmap</code> 绘制。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotHeatmap</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_unbound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HHealthy_unbound</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signals </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../HCC/tobias/HCC_uncorrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_uncorrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signal-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_uncorrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_uncorrected</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--output </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">FOXA1_MA0148.4_PlotHeatmap.pdf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--plot_boundaries</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[138]||(s[138]=i("strong",null,"FOXA1_MA0148.4_PlotHeatmap.pdf",-1)),s[139]||(s[139]=a()),s[140]||(s[140]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/FOXA1_MA0148.4_PlotHeatmap.png",style:{zoom:"12%"}})],-1))])]),s[156]||(s[156]=i("h3",{id:"_7-3-筛选位点",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_7-3-筛选位点"},[i("span",null,"7.3 筛选位点")])],-1)),i("ul",null,[i("li",null,[i("p",null,[s[141]||(s[141]=a("我写了个 ")),n(p,{name:"devicon-plain:bash",size:"2em"}),s[142]||(s[142]=a()),s[143]||(s[143]=i("code",null,"shell",-1)),s[144]||(s[144]=a(" 脚本 ")),s[145]||(s[145]=i("code",null,"filter.sh",-1)),s[146]||(s[146]=a(" ，用于筛选前 20 个位点。"))]),s[147]||(s[147]=k(`<div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 过滤条件 HCC_bound + Healthy_bound == 2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">awk</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -F</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">NR == 1 { next } $12 + $13 == 2 {print $0}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/FOXA1_MA0148.4_overview.txt </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 按 Healthy_score 降序排序, 并取前 20 行</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sort</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">$&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -k11,11nr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> head</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 20</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成 plot_regions 数据</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">awk</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -F</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    { </span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        plot_start = $8 - 1000;          # $8 是 peak_start</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        plot_end = $9 + 1000;            # $9 是 peak_end</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        print $7, plot_start, plot_end;  # 输出 peak_chr, plot_start, plot_end</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    }</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> OFS=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">plot_regions.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 清理中间文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))]),s[152]||(s[152]=k(`<li><p>使用 <code>TOBIAS PlotTracks</code> 绘制 <code>IGV</code> 风格的全基因组信号轨迹，以观察足迹分布。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotTracks</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/HCC1/macs3/HCC1_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/HCC2/macs3/HCC2_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/Healthy1/macs3/Healthy1_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/Healthy2/macs3/Healthy2_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/HCC/tobias/HCC_footprints.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/Healthy/tobias/Healthy_footprints.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--regions </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">plot_regions.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--sites </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_all.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--highlight </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_all.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--gtf </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../data/Homo_sapiens.GRCh38.100.chr.gtf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--colors </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,1)),i("li",null,[i("p",null,[s[148]||(s[148]=a("20 个位点汇总成一个 ")),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[149]||(s[149]=a()),s[150]||(s[150]=i("strong",null,"all_plots.pdf",-1)),s[151]||(s[151]=a("。"))]),n(r,{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/all_plots.pdf",title:"all_plots.pdf",page:1,"no-toolbar":!1,width:"100%",height:"",ratio:"4:3",zoom:120})])])])]),s[282]||(s[282]=k('<h2 id="_8-差异分析" tabindex="-1"><a class="header-anchor" href="#_8-差异分析"><span>8. 差异分析</span></a></h2><h3 id="_8-1-准备工作" tabindex="-1"><a class="header-anchor" href="#_8-1-准备工作"><span>8.1 准备工作</span></a></h3><ul><li><p>构建样本元数据表 ( <code>~/myATAC-seq/data/sheet.csv</code>)：</p><table><thead><tr><th>SampleID</th><th>Tissue</th><th>Factor</th><th>Condition</th><th>Treatment</th><th>Replicate</th><th>bamReads</th><th>Peaks</th><th>PeakCaller</th></tr></thead><tbody><tr><td>Healthy1</td><td>NA</td><td>Healthy_Factor</td><td>Healthy_Condition</td><td>HCV-</td><td>1</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy1/alignmentSieve/ATACshifted_Healthy1_sorted.bam</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy1/macs3/Healthy1_peaks.narrowPeak</td><td>bed</td></tr><tr><td>Healthy2</td><td>NA</td><td>Healthy_Factor</td><td>Healthy_Condition</td><td>HCV+</td><td>2</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy2/alignmentSieve/ATACshifted_Healthy2_sorted.bam</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy2/macs3/Healthy2_peaks.narrowPeak</td><td>bed</td></tr><tr><td>HCC1</td><td>NA</td><td>HCC_Factor</td><td>HCC_Condition</td><td>HCV-</td><td>1</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC1/alignmentSieve/ATACshifted_HCC1_sorted.bam</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC1/macs3/HCC1_peaks.narrowPeak</td><td>bed</td></tr><tr><td>HCC2</td><td>NA</td><td>HCC_Factor</td><td>HCC_Condition</td><td>HCV+</td><td>2</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC2/alignmentSieve/ATACshifted_HCC2_sorted.bam</td><td>/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC2/macs3/HCC2_peaks.narrowPeak</td><td>bed</td></tr></tbody></table></li></ul><h3 id="_8-2-代码" tabindex="-1"><a class="header-anchor" href="#_8-2-代码"><span>8.2 代码</span></a></h3>',4)),i("ul",null,[i("li",null,[i("p",null,[s[157]||(s[157]=a("直接使用 ")),n(p,{name:"vscode-icons:file-type-r",size:"2em"}),s[158]||(s[158]=a()),s[159]||(s[159]=i("code",null,"Rscript",-1)),s[160]||(s[160]=a(" 运行："))]),s[161]||(s[161]=k('<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Rscript</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/R_diffbind/diffbind.R</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>',1))]),i("li",null,[n(p,{name:"vscode-icons:file-type-r",size:"2em"}),s[162]||(s[162]=k(` R 代码详情如下 (点击下方箭头展开查看完整代码) ：<div class="language-r line-numbers-mode has-collapsed collapsed" data-ext="r" data-title="r" style="--vp-collapsed-lines:15;"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(DiffBind)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(tidyverse)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(corrplot)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(PCAtools)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 新建文件夹</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">output_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">~/myATAC-seq/diffbind</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dir.create</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">recursive</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 切换工作目录</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">setwd</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 加载样本信息</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> read.csv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">~/myATAC-seq/data/sheet.csv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sep</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sampleSheet</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 构建 DiffBind 对象</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> data.frame</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">doBlacklist</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> doGreylist</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bRemoveM</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bRemoveRandom</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 计算峰值</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">summits</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 200</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 峰宽 = 2 * summits + 1</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bUseSummarizeOverlaps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 更准，更慢</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">score</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBA_SCORE_RPKM</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 标准化</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.normalize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">normalize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBA_NORM_TMM</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 提取 FPKM 数据</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> diff_bind_obj</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">$</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">binding </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">%&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">as_tibble</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mutate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">peak_id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str_c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">chr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CHR</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> START</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">_</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> END</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">column_to_rownames</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">var</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">peak_id</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">select</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">CHR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">START</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">END</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 绘制相关性热图并保存为 PDF</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">correlation_plot.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">corrplot</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cor</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addCoef.col</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">white</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># PCA 分析</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pca</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pca</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> metadata</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> column_to_rownames</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> var</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">SampleID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 绘制 PCA 二维图并保存为 PDF</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pca_biplot.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">biplot</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(pca, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">colby</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Factor</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 差异分析</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy_Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">minMembers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.analyze</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 差异分析结果展示</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># (这里的韦恩图好像没啥意义...)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># pdf(file = file.path(output_dir, &quot;differential_binding_venn.pdf&quot;))</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dba.plotVenn(diff_bind_obj, contrast = 1, bDB = TRUE, bGain = TRUE, bLoss = TRUE, bAll = FALSE)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dev.off()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 火山图</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">differential_binding_volcano.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dba.plotVolcano</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 保存差异结果表</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.report</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_table</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> as.data.frame</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(diff_bind_result)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">write.csv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(diff_bind_table, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">diff_bind_results.csv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">), </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">row.names</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打印差异分析对比结果</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">print</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dba.show</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> bContrasts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div>`,2))])]),s[283]||(s[283]=i("h3",{id:"_8-3-结果",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_8-3-结果"},[i("span",null,"8.3 结果")])],-1)),i("ul",null,[i("li",null,[s[163]||(s[163]=i("p",null,"三张图。",-1)),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[164]||(s[164]=a()),s[165]||(s[165]=i("strong",null,"correlation_plot.pdf",-1)),s[166]||(s[166]=a()),s[167]||(s[167]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/correlation_plot.png",style:{zoom:"25%"}})],-1)),s[168]||(s[168]=i("hr",null,null,-1)),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[169]||(s[169]=a()),s[170]||(s[170]=i("strong",null,"pca_biplot.pdf",-1)),s[171]||(s[171]=a()),s[172]||(s[172]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/pca_biplot.png",style:{zoom:"25%"}})],-1)),s[173]||(s[173]=i("hr",null,null,-1)),n(p,{name:"vscode-icons:file-type-pdf2",size:"2em"}),s[174]||(s[174]=a()),s[175]||(s[175]=i("strong",null,"differential_binding_volcano.pdf",-1)),s[176]||(s[176]=a()),s[177]||(s[177]=i("br",null,null,-1)),s[178]||(s[178]=i("br",null,null,-1)),s[179]||(s[179]=i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/differential_binding_volcano.png",style:{zoom:"30%"}})],-1))])]),s[284]||(s[284]=i("hr",null,null,-1)),s[285]||(s[285]=i("ul",null,[i("li",null,[a("最后来一张深度为 2 的 "),i("code",null,"tree"),a(" 作为收尾。")])],-1)),i("div",b,[i("ul",null,[n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",v,[n(l,{name:"vscode-icons:default-folder"}),s[180]||(s[180]=i("span",{class:"name"},"bindetect",-1))]),i("ul",null,[n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",B,[n(l,{name:"vscode-icons:default-folder"}),s[181]||(s[181]=i("span",{class:"name"},"footprinting",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",f,[n(l,{name:"vscode-icons:default-folder"}),s[182]||(s[182]=i("span",{class:"name"},"HCC",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",c,[n(l,{name:"vscode-icons:default-folder"}),s[183]||(s[183]=i("span",{class:"name"},"Healthy",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",E,[n(l,{name:"vscode-icons:default-folder"}),s[184]||(s[184]=i("span",{class:"name"},"motif",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",q,[n(l,{name:"vscode-icons:default-folder"}),s[185]||(s[185]=i("span",{class:"name"},"peak_merge",-1))])]),_:1})])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",x,[n(l,{name:"vscode-icons:folder-type-db"}),s[186]||(s[186]=i("span",{class:"name"},"data",-1))]),i("ul",null,[n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",_,[n(l,{name:"vscode-icons:default-folder"}),s[187]||(s[187]=i("span",{class:"name"},"blacklist.v2",-1)),s[188]||(s[188]=i("span",{class:"comment"},"-> /public/workspace/shaojf/Course/NGS/Reference/ENCODE/blacklist.v2/",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",H,[n(l,{name:"vscode-icons:default-folder"}),s[189]||(s[189]=i("span",{class:"name"},"BWA_Index",-1)),s[190]||(s[190]=i("span",{class:"comment"},"-> /public/workspace/shaojf/Course/NGS/Reference/BWA_Index/",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",R,[n(l,{name:"vscode-icons:default-file"}),s[191]||(s[191]=i("span",{class:"name"},"Homo_sapiens.GRCh38.100.chr.gtf",-1)),s[192]||(s[192]=i("span",{class:"comment"},"-> /public/workspace/shaojf/Course/NGS/Reference/Ensembl/Homo_sapiens.GRCh38.100.chr.gtf",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",S,[n(l,{name:"vscode-icons:default-file"}),s[193]||(s[193]=i("span",{class:"name"},"motif_databases",-1)),s[194]||(s[194]=i("span",{class:"comment"},"-> /public/workspace/shaojf/Course/NGS/Reference/MEME/motif_databases/",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",T,[n(l,{name:"vscode-icons:file-type-excel"}),s[195]||(s[195]=i("span",{class:"name"},"sheet.csv",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",w,[n(l,{name:"vscode-icons:default-file"}),s[196]||(s[196]=i("span",{class:"name"},"SRR13849295_1.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",z,[n(l,{name:"vscode-icons:default-file"}),s[197]||(s[197]=i("span",{class:"name"},"SRR13849295_2.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",M,[n(l,{name:"vscode-icons:default-file"}),s[198]||(s[198]=i("span",{class:"name"},"SRR13849301_1.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",F,[n(l,{name:"vscode-icons:default-file"}),s[199]||(s[199]=i("span",{class:"name"},"SRR13849301_2.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",P,[n(l,{name:"vscode-icons:default-file"}),s[200]||(s[200]=i("span",{class:"name"},"SRR13849307_1.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",N,[n(l,{name:"vscode-icons:default-file"}),s[201]||(s[201]=i("span",{class:"name"},"SRR13849307_2.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",O,[n(l,{name:"vscode-icons:default-file"}),s[202]||(s[202]=i("span",{class:"name"},"SRR13849313_1.fastq.gz",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",G,[n(l,{name:"vscode-icons:default-file"}),s[203]||(s[203]=i("span",{class:"name"},"SRR13849313_2.fastq.gz",-1))])]),_:1})])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",I,[n(l,{name:"vscode-icons:default-folder"}),s[204]||(s[204]=i("span",{class:"name"},"diffbind",-1))]),i("ul",null,[n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",j,[n(l,{name:"vscode-icons:file-type-pdf2"}),s[205]||(s[205]=i("span",{class:"name"},"correlation_plot.pdf",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",V,[n(l,{name:"vscode-icons:file-type-excel"}),s[206]||(s[206]=i("span",{class:"name"},"diff_bind_results.csv",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",X,[n(l,{name:"vscode-icons:file-type-pdf2"}),s[207]||(s[207]=i("span",{class:"name"},"differential_binding_volcano.pdf",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",$,[n(l,{name:"vscode-icons:file-type-pdf2"}),s[208]||(s[208]=i("span",{class:"name"},"pca_biplot.pdf",-1))])]),_:1})])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",W,[n(l,{name:"vscode-icons:file-type-license"}),s[209]||(s[209]=i("span",{class:"name"},"LICENSE",-1))])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",L,[n(l,{name:"vscode-icons:default-folder"}),s[210]||(s[210]=i("span",{class:"name"},"pre_and_peakcalling",-1))]),i("ul",null,[n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",U,[n(l,{name:"vscode-icons:default-folder"}),s[211]||(s[211]=i("span",{class:"name"},"HCC1",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",J,[n(l,{name:"vscode-icons:default-folder"}),s[212]||(s[212]=i("span",{class:"name"},"HCC2",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",K,[n(l,{name:"vscode-icons:default-folder"}),s[213]||(s[213]=i("span",{class:"name"},"Healthy1",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",Q,[n(l,{name:"vscode-icons:default-folder"}),s[214]||(s[214]=i("span",{class:"name"},"Healthy2",-1))])]),_:1})])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",Y,[n(l,{name:"vscode-icons:default-folder"}),s[215]||(s[215]=i("span",{class:"name"},"R_diffbind",-1))]),i("ul",null,[n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",Z,[n(l,{name:"vscode-icons:file-type-r"}),s[216]||(s[216]=i("span",{class:"name"},"diffbind.R",-1))])]),_:1})])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",ss,[n(l,{name:"flat-color-icons:info"}),s[217]||(s[217]=i("span",{class:"name"},"README.md",-1))])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",is,[n(l,{name:"vscode-icons:default-folder"}),s[218]||(s[218]=i("span",{class:"name"},"singularity",-1))]),i("ul",null,[n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",as,[n(l,{name:"vscode-icons:default-file"}),s[219]||(s[219]=i("span",{class:"name"},"ATAC_seq_pipeline.def",-1))])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",ns,[n(l,{name:"vscode-icons:folder-type-dist"}),s[220]||(s[220]=i("span",{class:"name"},"bin",-1))]),i("ul",null,[n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",ls,[n(l,{name:"vscode-icons:default-file"}),s[221]||(s[221]=i("span",{class:"name"},"micromamba",-1))])]),_:1})])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",es,[n(l,{name:"vscode-icons:default-file"}),s[222]||(s[222]=i("span",{class:"name"},"debian.sources",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",ts,[n(l,{name:"vscode-icons:file-type-light-yaml"}),s[223]||(s[223]=i("span",{class:"name"},"env_ATAC_seq.yml",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",ps,[n(l,{name:"vscode-icons:file-type-light-yaml"}),s[224]||(s[224]=i("span",{class:"name"},"env_idr.yml",-1))])]),_:1}),n(e,{type:"file",expanded:!1,empty:!0},{default:t(()=>[i("span",ks,[n(l,{name:"vscode-icons:default-file"}),s[225]||(s[225]=i("span",{class:"name"},"myATAC-seq.sif",-1))])]),_:1})])]),_:1}),n(e,{type:"folder",expanded:!0,empty:!1},{default:t(()=>[i("span",ds,[n(l,{name:"vscode-icons:default-folder"}),s[226]||(s[226]=i("span",{class:"name"},"snakemake",-1))]),i("ul",null,[n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",hs,[n(l,{name:"vscode-icons:default-folder"}),s[227]||(s[227]=i("span",{class:"name"},"bindetect",-1))])]),_:1}),n(e,{type:"folder",expanded:!1,empty:!0},{default:t(()=>[i("span",rs,[n(l,{name:"vscode-icons:default-folder"}),s[228]||(s[228]=i("span",{class:"name"},"pre_and_peakcalling",-1))])]),_:1})])]),_:1})])]),s[286]||(s[286]=k('<h2 id="_9-总结" tabindex="-1"><a class="header-anchor" href="#_9-总结"><span>9. 总结</span></a></h2><h3 id="_9-1-小技巧" tabindex="-1"><a class="header-anchor" href="#_9-1-小技巧"><span>9.1 小技巧</span></a></h3><h4 id="_9-1-1-快速查看服务器上的文件" tabindex="-1"><a class="header-anchor" href="#_9-1-1-快速查看服务器上的文件"><span>9.1.1 快速查看服务器上的文件</span></a></h4>',3)),i("ul",null,[i("li",null,[i("p",null,[s[229]||(s[229]=a("想要查看结果文件（PDF、HTML、PNG等），可以先 ")),s[230]||(s[230]=i("code",null,"cd",-1)),s[231]||(s[231]=a(" 到相应路径，然后使用 ")),n(p,{name:"vscode-icons:file-type-python",size:"2em"}),s[232]||(s[232]=a()),s[233]||(s[233]=i("code",null,"python3",-1)),s[234]||(s[234]=a(" 中的 ")),s[235]||(s[235]=i("code",null,"http.server",-1)),s[236]||(s[236]=a(" 模块将文件夹临时暴露成类似于 ")),n(p,{name:"logos:nginx",size:"2em"}),s[237]||(s[237]=a()),s[238]||(s[238]=i("code",null,"nginx",-1)),s[239]||(s[239]=a(" 那样的静态文件服务（ 11111 是端口号，可以随便设置，建议范围在 10000 - 60000 之间 ）："))]),s[240]||(s[240]=k('<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -m</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http.server</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 11111</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>',1))]),s[241]||(s[241]=i("li",null,[i("p",null,[a("在本地电脑上的浏览器输入服务器对应的 "),i("code",null,"ip地址:端口"),a(" ，即可访问：")]),i("div",{style:{"text-align":"center"}},[i("img",{src:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/python_httpserver1.png",style:{zoom:"80%"}})])],-1))]),s[287]||(s[287]=i("h4",{id:"_9-1-2-命令行下-pdf-转-png",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_9-1-2-命令行下-pdf-转-png"},[i("span",null,[a("9.1.2 命令行下 "),i("code",null,"pdf"),a(" 转 "),i("code",null,"png")])])],-1)),i("ul",null,[i("li",null,[i("p",null,[s[242]||(s[242]=a("使用 ")),n(p,{name:"streamline:magic-wand-2-solid",size:"2em"}),s[243]||(s[243]=a()),s[244]||(s[244]=i("code",null,"magick",-1)),s[245]||(s[245]=a(" 软件可以通过命令行快速进行常见图片格式的转换操作。需要使用 ")),n(p,{name:"vscode-icons:file-type-conda",size:"2em"}),s[246]||(s[246]=a()),s[247]||(s[247]=i("code",null,"conda",-1)),s[248]||(s[248]=a(" 或 ")),s[249]||(s[249]=i("code",null,"micromamba",-1)),s[250]||(s[250]=a(" 安装 ")),n(p,{name:"streamline:magic-wand-2-solid",size:"2em"}),s[251]||(s[251]=a()),s[252]||(s[252]=i("code",null,"magick",-1)),s[253]||(s[253]=a(" 软件后使用。"))]),s[254]||(s[254]=k(`<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 假如你用的是 anaconda/miniconda</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">conda</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> conda-forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> imagemagick</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 假如你用的是 micromamba</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">micromamba</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> conda-forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> imagemagick</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># pdf转png (density是分辨率，ppi)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">magick</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -density</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 300</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> foo.pdf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> foo.png</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))])]),s[288]||(s[288]=k('<h3 id="_9-2-注意" tabindex="-1"><a class="header-anchor" href="#_9-2-注意"><span>9.2 注意</span></a></h3><ol><li><code>peak_merge</code> 的结果需要手动去除线粒体 DNA ，我使用的是 <code>grep -Ev &#39;(chrM|chrMT|M|MT|Mito)&#39;</code> 。</li><li><code>DiffBind</code> 输入只能为 <code>bam</code> 或 <code>bed</code> 或 <code>bed.gz</code>，<code>alignmentSieve</code> 那步输出不可为 <code>bedpe</code>，而且还需要再次 <code>samtools</code> 排序。</li><li>通过 <code>conda-forge</code> 源安装的 <code>singularity</code> 在某些系统上可能会出现 <code>Failed to create user namespace: user namespace disabled: exit status 1</code> ，可以联系服务器管理员临时调整最大用户命名空间：<code>sudo sysctl user.max_user_namespaces=65536</code>，或永久调整：<code>echo &quot;user.max_user_namespaces=65536&quot; &gt;&gt; /etc/sysctl.conf</code></li><li>使用 <code>Diffbind</code> 中的 <code>dba.count</code> 函数时，中生成的 <code>.bam</code> 文件需要按照参考基因组的位置进行排序，我在 <code>pre_and_peakcalling</code> 的 “偏移修正” 里面已经使用 <code>samtools</code> 排序了。</li></ol><h2 id="_10-参考文献" tabindex="-1"><a class="header-anchor" href="#_10-参考文献"><span>10. 参考文献</span></a></h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>Grandi, F.C., Modi, H., Kampman, L. <em>et al.</em> Chromatin accessibility profiling by ATAC-seq. <em>Nat Protoc</em> <strong>17</strong>, 1518–1552 (2022). https://doi.org/10.1038/s41596-022-00692-9 <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p>Bentsen, M., Goymann, P., Schultheis, H. <em>et al.</em> ATAC-seq footprinting unravels kinetics of transcription factor binding during zygotic genome activation. <em>Nat Commun</em> <strong>11</strong>, 4267 (2020). https://doi.org/10.1038/s41467-020-18035-1 <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li></ol></section>',5))])}const ys=o(m,[["render",os],["__file","index.html.vue"]]),us=JSON.parse(`{"path":"/NGS/2anb5jfk/","title":"Project 01","lang":"zh-CN","frontmatter":{"title":"Project 01","createTime":"2024/10/31 23:39:51","permalink":"/NGS/2anb5jfk/","description":"2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组 基于 1. 前言 1.1 背景 慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者，其中 10-20% 的患者在其一生中可能出现严重的肝脏并发症。表观遗传机制 ( 如 DNA 甲基化和...","head":[["meta",{"property":"og:url","content":"https://meteor-oxalis3.com/NGS/2anb5jfk/"}],["meta",{"property":"og:site_name","content":"Meteor03's Oxalis Garden"}],["meta",{"property":"og:title","content":"Project 01"}],["meta",{"property":"og:description","content":"2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组 基于 1. 前言 1.1 背景 慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者，其中 10-20% 的患者在其一生中可能出现严重的肝脏并发症。表观遗传机制 ( 如 DNA 甲基化和..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://meteor-oxalis3.com/home/saturn/10_Typora/NGS_Project01/ATAC_seq_Data.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Project 01\\",\\"image\\":[\\"https://meteor-oxalis3.com/home/saturn/10_Typora/NGS_Project01/ATAC_seq_Data.png\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"1. 前言","slug":"_1-前言","link":"#_1-前言","children":[{"level":3,"title":"1.1 背景","slug":"_1-1-背景","link":"#_1-1-背景","children":[]},{"level":3,"title":"1.2 目标","slug":"_1-2-目标","link":"#_1-2-目标","children":[]}]},{"level":2,"title":"2. 相关网址","slug":"_2-相关网址","link":"#_2-相关网址","children":[]},{"level":2,"title":"3. 数据来源","slug":"_3-数据来源","link":"#_3-数据来源","children":[]},{"level":2,"title":"4. 环境工具","slug":"_4-环境工具","link":"#_4-环境工具","children":[]},{"level":2,"title":"5. 准备工作","slug":"_5-准备工作","link":"#_5-准备工作","children":[{"level":3,"title":"5.1 数据准备","slug":"_5-1-数据准备","link":"#_5-1-数据准备","children":[]},{"level":3,"title":"5.2 环境配置","slug":"_5-2-环境配置","link":"#_5-2-环境配置","children":[]}]},{"level":2,"title":"6. 数据预处理 + Peak Calling","slug":"_6-数据预处理-peak-calling","link":"#_6-数据预处理-peak-calling","children":[{"level":3,"title":"6.1 代码","slug":"_6-1-代码","link":"#_6-1-代码","children":[]}]},{"level":2,"title":"7. 足迹识别","slug":"_7-足迹识别","link":"#_7-足迹识别","children":[{"level":3,"title":"7.1 代码","slug":"_7-1-代码","link":"#_7-1-代码","children":[]},{"level":3,"title":"7.2 单个 motif 分析","slug":"_7-2-单个-motif-分析","link":"#_7-2-单个-motif-分析","children":[]}]},{"level":2,"title":"8. 差异分析","slug":"_8-差异分析","link":"#_8-差异分析","children":[{"level":3,"title":"8.1 准备工作","slug":"_8-1-准备工作","link":"#_8-1-准备工作","children":[]},{"level":3,"title":"8.2 代码","slug":"_8-2-代码","link":"#_8-2-代码","children":[]},{"level":3,"title":"8.3 结果","slug":"_8-3-结果","link":"#_8-3-结果","children":[]}]},{"level":2,"title":"9. 总结","slug":"_9-总结","link":"#_9-总结","children":[{"level":3,"title":"9.1 小技巧","slug":"_9-1-小技巧","link":"#_9-1-小技巧","children":[]},{"level":3,"title":"9.2 注意","slug":"_9-2-注意","link":"#_9-2-注意","children":[]}]},{"level":2,"title":"10. 参考文献","slug":"_10-参考文献","link":"#_10-参考文献","children":[]}],"readingTime":{"minutes":12.96,"words":3889},"git":{},"autoDesc":true,"filePathRelative":"notes/NGS/Project_01.md"}`);export{ys as comp,us as data};
