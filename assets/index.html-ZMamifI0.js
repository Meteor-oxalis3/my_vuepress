import{_ as p,c as k,a as n,b as i,d as a,e as l,o as d,r as t}from"./app-CkmBGrhx.js";const r="/assets/ATAC_seq_Data-GOdraREB.png",c="/assets/pre--4iH4TwV.png",A="/assets/snakemake_workflow-C0Yb4Pw8.png",g="/assets/FOXA1_MA0148.4_PlotAggregate-oZQH2DQ-.png",o="/assets/FOXA1_MA0148.4_PlotHeatmap-i9TLYZu9.png",y="/assets/4-2260960-2263835-BVAFkN9u.png",D="/assets/12-114683033-114685961-5o-wxtTt.png",C="/assets/16-4615067-4617804-DB8R00cB.png",u="/assets/correlation_plot-Dwp-GQyq.png",B="/assets/pca_biplot-BllAh5FO.png",m="/assets/differential_binding_volcano-BVo5w3Dj.png",v="/assets/python_httpserver1-hGsBfTia.png",b={};function _(E,s){const e=t("Icon"),h=t("ImageCard");return d(),k("div",null,[s[8]||(s[8]=n('<p>2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组</p><hr><h1 id="基于-snakemake-的-atac-seq-足迹识别与差异分析流程开发及应用-以-hcv-相关肝癌为例" tabindex="-1"><a class="header-anchor" href="#基于-snakemake-的-atac-seq-足迹识别与差异分析流程开发及应用-以-hcv-相关肝癌为例"><span>基于 Snakemake 的 ATAC-seq 足迹识别与差异分析流程开发及应用：以 HCV 相关肝癌为例</span></a></h1><h2 id="_1-前言" tabindex="-1"><a class="header-anchor" href="#_1-前言"><span>1. 前言</span></a></h2><h3 id="_1-1-背景" tabindex="-1"><a class="header-anchor" href="#_1-1-背景"><span>1.1 背景</span></a></h3><ul><li><p>慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者，其中 10-20% 的患者在其一生中可能出现严重的肝脏并发症。表观遗传机制 ( 如 DNA 甲基化和组蛋白修饰 ) 在多种疾病过程中，尤其是肝病的发生和发展中，发挥了关键作用。HCV 感染能够显著改变这些表观遗传标记，并可能在感染治愈后留下 “表观遗传疤痕” ，从而导致长期的基因调控异常和癌症风险。</p></li><li><p>近年来，直接作用抗病毒药物 ( DAA ) 的发展为 HCV 的治愈提供了新的希望。然而，临床观察表明，即使在达到持续病毒学应答( SVR ) 后，患者的 HCC 风险仍未完全消除。这提示 HCV 感染可能通过持久的表观遗传损伤影响肝脏细胞功能，为理解这些过程的分子机制提供了研究必要性。</p></li></ul><h3 id="_1-2-目标" tabindex="-1"><a class="header-anchor" href="#_1-2-目标"><span>1.2 目标</span></a></h3><ul><li>​为了揭示 HCV 感染如何通过表观遗传途径影响肝细胞功能，以及在病毒清除后这些改变是否仍然持续，本研究构建了基于 Snakemake 的 ATAC-seq 足迹分析与差异分析流程，对相关数据进行系统性分析。具体目标包括：</li></ul><ol><li>构建高效、可重复的 Snakemake 流程，用于 ATAC-seq 数据的标准化处理、足迹识别和差异分析</li><li>比较 HCV 感染前后肝细胞系 ( Huh7.5 和 Hu1545 ) 染色质开放性和转录调控的变化</li><li>评估 HCV 治愈后，表观遗传标记的改变是否能够恢复正常</li><li>阐明 HCV 感染和治愈过程中关键基因失调的分子机制，为治疗策略优化提供数据支持</li></ol><h2 id="_2-相关网址" tabindex="-1"><a class="header-anchor" href="#_2-相关网址"><span>2. 相关网址</span></a></h2>',10)),i("ul",null,[i("li",null,[s[0]||(s[0]=a("代码仓库：")),l(e,{name:"octicon:mark-github-16",size:"2em"}),s[1]||(s[1]=a()),s[2]||(s[2]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/",target:"_blank",rel:"noopener noreferrer"},"Meteor-oxalis3 myATAC-seq",-1))])]),s[9]||(s[9]=n('<h2 id="_3-数据来源" tabindex="-1"><a class="header-anchor" href="#_3-数据来源"><span>3. 数据来源</span></a></h2><ul><li>GEO：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE168178</li><li>文献：https://pmc.ncbi.nlm.nih.gov/articles/PMC9416882/</li></ul><blockquote><p>Hu1545 was derived from primary human hepatocytes from a de-identified donor without liver disease. Huh7.5 is a derivative of the Huh7 HCC cell line with a RIG-I mutation that leaves the cell line more susceptible to HCV infection</p></blockquote><p><img src="'+r+`" alt="ATAC_seq_Data"></p><h2 id="_4-环境工具" tabindex="-1"><a class="header-anchor" href="#_4-环境工具"><span>4. 环境工具</span></a></h2><ul><li>流程语言：<a href="https://snakemake.readthedocs.io/" target="_blank" rel="noopener noreferrer">Snakemake v8.25.5</a></li><li>软件包管理：<a href="https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html" target="_blank" rel="noopener noreferrer">Micromamba v2.0.4</a></li><li>环境打包分发：<a href="https://docs.sylabs.io/guides/3.8/user-guide/" target="_blank" rel="noopener noreferrer">Singularity v3.8.6</a></li></ul><h2 id="_5-准备工作" tabindex="-1"><a class="header-anchor" href="#_5-准备工作"><span>5. 准备工作</span></a></h2><h3 id="_5-1-数据准备" tabindex="-1"><a class="header-anchor" href="#_5-1-数据准备"><span>5.1 数据准备</span></a></h3><ul><li><p>考虑到国内下载 SRA 的速度太慢，我在“赛博活菩萨”—— Cloudflare 那里搭建了一个镜像网站用于加速下载。还编写了一个 shell 小脚本 ( <code>cf-sra-get.sh</code> ) 进一步方便下载数据。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 检查是否提供了参数</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -z</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> then</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Usage: $0 &lt;SRR_ID&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    exit</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 获取传入的SRR编号</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">SRR_ID</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">$1</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">SRA_NAME</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$SRR_ID.sra</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 下载文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -LS</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://sra.meteor-oxalis3.com/sra/$SRR_ID/$SRR_ID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $SRA_NAME</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>开始下载数据：</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +x</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cf-sra-get.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849295</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849301</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849307</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./cf-sra-get.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849313</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>我定义的样本名称与对应的SRR号：</p><table><thead><tr><th style="text-align:center;">样本名称</th><th style="text-align:center;">SRR号</th><th style="text-align:left;">细胞类型</th></tr></thead><tbody><tr><td style="text-align:center;">Healthy1</td><td style="text-align:center;"><code>SRR13849295</code></td><td style="text-align:left;">Hu1545_ATAC</td></tr><tr><td style="text-align:center;">Healthy2</td><td style="text-align:center;"><code>SRR13849301</code></td><td style="text-align:left;">Hu1545_HCV_ATAC</td></tr><tr><td style="text-align:center;">HCC1</td><td style="text-align:center;"><code>SRR13849307</code></td><td style="text-align:left;">Huh7.5_ATAC</td></tr><tr><td style="text-align:center;">HCC2</td><td style="text-align:center;"><code>SRR13849313</code></td><td style="text-align:left;">Huh7.5_HCV_ATAC</td></tr></tbody></table></li><li><p>接下来我使用 <code>fasterq-dump</code> + <code>pigz</code> 的组合进行 <code>.sra</code> 转 <code>.fastq.gz</code>，比 <code>fastq-dump --gzip</code> 快不少 。</p></li></ul><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fasterq-dump</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -e</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --split-files</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.sra</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pigz</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> *</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.fastq</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mv</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> *</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.fastq.gz</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_5-2-环境配置" tabindex="-1"><a class="header-anchor" href="#_5-2-环境配置"><span>5.2 环境配置</span></a></h3>`,12)),i("ul",null,[s[6]||(s[6]=n("<li><p>我采用了 <code>micromamba</code> 与 <code>singularity</code> 相结合的方案进行软件版本控制与分发：通过定义 <code>ATAC_seq_pipeline.def</code> 文件，在 <code>debian:bookworm-slim</code> 基础镜像中调用 <code>miccromamba</code> ，使用 <code>env_ATAC_seq.yml</code> 与 <code>env_idr.yml</code> 文件自动化构建 <code>myATAC-seq.sif</code> 镜像。当然，也可以使用 <code>conda</code> 或者 <code>micromamba</code> 直接构建虚拟环境。</p></li>",1)),i("li",null,[i("p",null,[s[3]||(s[3]=a("相关文件网址：")),l(e,{name:"octicon:mark-github-16",size:"2em"}),s[4]||(s[4]=a()),s[5]||(s[5]=i("a",{href:"https://github.com/Meteor-oxalis3/myATAC-seq/tree/main/singularity",target:"_blank",rel:"noopener noreferrer"},"https://github.com/Meteor-oxalis3/myATAC-seq/tree/main/singularity",-1))])]),s[7]||(s[7]=i("li",null,[i("p",null,[a("这里我在我的 "),i("code",null,"Fedora 41"),a(" 笔记本上构建好 "),i("code",null,"singularity"),a(" 镜像，再通过 "),i("code",null,"sftp"),a(" 传输到 "),i("code",null,".9"),a(" 服务器进行后续的数据处理。")])],-1))]),s[10]||(s[10]=n(`<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 首先克隆我的代码仓库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> clone</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> git@github.com:Meteor-oxalis3/myATAC-seq.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 接着进入 singularity 的 .def 文件所在的文件夹</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myATAC-seq/singularity</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开始构建 .sif 镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">singularity</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> build</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --fakeroot</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myATAC-seq.sif</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ATAC_seq_pipeline.def</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>根据我之前折腾 <code>docker</code> 和 <code>singularity</code> 的经验，软链接相应文件后，挂载自己 home 路径之外的数据可以直接挂载所在用户的家目录，无需在自己的 home 路径新建同名文件夹。</p></li><li><p>借用一下邵老师下载好的相关数据，嘻嘻。</p></li></ul><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/data</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/BWA_Index/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/ENCODE/blacklist.v2/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/MEME/motif_databases/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/Ensembl/Homo_sapiens.GRCh38.100.chr.gtf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>流程运行时间长，所以我在 <code>tmux</code> 里面运行 <code>singularity</code> 。</li></ul><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tmux</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">myATAC-seq</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/pre_and_peakcalling</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/pre_and_peakcalling</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">singularity</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shell</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --bind</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf:/public/workspace/shaojf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../singularity/myATAC-seq.sif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_6-数据预处理-peak-calling" tabindex="-1"><a class="header-anchor" href="#_6-数据预处理-peak-calling"><span>6. 数据预处理 + Peak Calling</span></a></h2><ul><li><p>参考这篇文献<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>推荐的预处理步骤，我使用 <code>snakemake</code> 编写了一个流程，实现了从 ATAC-Seq 双末端测序的原始数据到 Peak Calling 的完整过程。</p><img src="`+c+`" style="zoom:16%;"></li></ul><h3 id="_6-1-代码" tabindex="-1"><a class="header-anchor" href="#_6-1-代码"><span>6.1 代码</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849307_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849307_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849313_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849313_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849295_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849295_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/pre_and_peakcalling/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">bwa_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849301_1.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">fastq2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/SRR13849301_2.fastq.gz</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">blacklist=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/blacklist.v2/hg38-blacklist.v2.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(下列 <code>smk</code> 详细代码请点击 <a href="https://github.com/Meteor-oxalis3/myATAC-seq/tree/main/snakemake/pre_and_peakcalling/rules" target="_blank" rel="noopener noreferrer">myATAC-seq_snakemake_pre_and_peakcalling_rules</a> 查看 )</p><h4 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备"><span>数据准备</span></a></h4><ul><li><p>&quot;link.smk&quot;</p><p>将原始 <code>fastq.gz</code> 数据文件软链接到特定文件夹，方便后续调用。</p></li></ul><h4 id="第一次质检" tabindex="-1"><a class="header-anchor" href="#第一次质检"><span>第一次质检</span></a></h4><ul><li><p>&quot;fastqc_raw.smk&quot;​</p><p>使用 <code>fastqc</code> 对原始下机数据进行第一次质量检查。</p></li></ul><h4 id="接头剪切" tabindex="-1"><a class="header-anchor" href="#接头剪切"><span>接头剪切</span></a></h4><ul><li><p>&quot;fastp.smk&quot;</p><p>使用 <code>fastp</code> 的双末端模式自动识别接头类型并进行剪切。</p></li></ul><h4 id="第二次质检" tabindex="-1"><a class="header-anchor" href="#第二次质检"><span>第二次质检</span></a></h4><ul><li><p>&quot;fastqc_trimmed.smk&quot;​</p><p>使用 <code>fastqc</code> 对剪切接头后的数据进行第二次质量检查。</p></li></ul><h4 id="序列比对" tabindex="-1"><a class="header-anchor" href="#序列比对"><span>序列比对</span></a></h4><ul><li><p>&quot;bwa.smk&quot;</p><p>使用 <code>bwa</code> 进行序列比对到参考基因组，生成 <code>.sam</code> 文件。</p></li></ul><h4 id="samtools-系列处理" tabindex="-1"><a class="header-anchor" href="#samtools-系列处理"><span>samtools 系列处理</span></a></h4><ul><li><p>&quot;samtools.smk&quot;</p><p>使用 <code>samtools</code> 对输入文件执行统计、格式转换、修复配对、排序、去重和索引等标准化处理步骤。</p></li></ul><h4 id="偏移修正" tabindex="-1"><a class="header-anchor" href="#偏移修正"><span>偏移修正</span></a></h4><ul><li><p>&quot;alignmentSieve.smk&quot;</p><p>使用 <code>deeptools</code> 里面的 <code>alignmentSieve</code> 工具过滤和调整测序比对数据，并且使用 <code>samtools</code> 按照参考基因组的位置进行排序，方便后续的 <code>Diffbind</code> 差异分析。</p></li></ul><h4 id="peak-calling" tabindex="-1"><a class="header-anchor" href="#peak-calling"><span>Peak Calling</span></a></h4><ul><li><p>&quot;macs3.smk&quot;</p><p>使用 <code>MACS3</code> 检测 peaks。</p></li></ul><h4 id="汇总预处理结果" tabindex="-1"><a class="header-anchor" href="#汇总预处理结果"><span>汇总预处理结果</span></a></h4><ul><li><p>&quot;multiqc.smk&quot;</p><p>使用 <code>multiqc</code> 将接头剪切和序列比对的结果进行汇总报告。</p></li></ul><hr><h2 id="_7-足迹识别" tabindex="-1"><a class="header-anchor" href="#_7-足迹识别"><span>7. 足迹识别</span></a></h2><p>​ 这里我参考了 <code>TOBIAS</code> 官方<sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>提供的流程图，自己编写了从上个流程的 4 个样本结果到 <code>BINDetect</code> 步骤的 <code>snakemake</code> 流程。</p><p><img src="`+A+'" alt="snakemake_workflow"></p>',36)),l(h,{image:"https://r2-hugo.meteor-oxalis3.com/02_NGS/Project_01/footprinting.png"}),s[11]||(s[11]=n(`<h3 id="_7-1-代码" tabindex="-1"><a class="header-anchor" href="#_7-1-代码"><span>7.1 代码</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">snakemake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../snakemake/bindetect/Snakefile</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--config </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">case_prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> control_prefix=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cores=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">20</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">case1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/HCC1/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">case2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/HCC2/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control1=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/Healthy1/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control2=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../pre_and_peakcalling/Healthy2/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">genome_index=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/BWA_Index/Homo_sapiens.GRCh38.dna.primary_assembly.fa.fai</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">motifs=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../data/motif_databases/JASPAR/JASPAR2022_CORE_vertebrates_non-redundant_v2.meme</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(下列 <code>smk</code> 详细代码请点击 <a href="https://github.com/Meteor-oxalis3/myATAC-seq/tree/main/snakemake/bindetect/rules" target="_blank" rel="noopener noreferrer">myATAC-seq_snakemake_bindetect_rules</a> 查看 )</p><h4 id="合并-bam" tabindex="-1"><a class="header-anchor" href="#合并-bam"><span>合并 BAM</span></a></h4><ul><li><p>&quot;samtools_merge_case.smk&quot;, &quot;samtools_merge_control.smk&quot;</p><p>由于 <code>TOBIAS</code> 不支持生物学重复，所以需要将各组的 bam 文件合并一下。</p></li></ul><h4 id="idr-分析" tabindex="-1"><a class="header-anchor" href="#idr-分析"><span>IDR 分析</span></a></h4><ul><li><p>&quot;idr_case.smk&quot;, &quot;idr_control.smk&quot;</p><p>使用 <code>IDR</code> 进行 Peak 过滤和筛选，接着使用 <code>awk</code> 将通过 IDR 阈值的 Peak 提取后转换为 narrowPeak 格式。</p></li></ul><h4 id="合并生成多样本共识-peaks" tabindex="-1"><a class="header-anchor" href="#合并生成多样本共识-peaks"><span>合并生成多样本共识 Peaks</span></a></h4><ul><li><p>&quot;bedtools_merge.smk&quot;</p><p>合并 <code>case</code> 组和 <code>control</code> 组的 IDR 结果，并通过 <code>bedtools</code> 对合并后的峰值进行排序和筛选，最后去除线粒体 DNA。</p></li></ul><h4 id="atacorrect-矫正" tabindex="-1"><a class="header-anchor" href="#atacorrect-矫正"><span>ATACorrect 矫正</span></a></h4><ul><li><p>&quot;tobias_ATACorrect_case.smk&quot;, &quot;tobias_ATACorrect_control.smk&quot;</p><p>使用 <code>TOBIAS</code> 对 <code>case</code> 组和 <code>control</code> 组的 BAM 文件和合并的 Peaks 进行 ATAC-seq 偏倚校正 Tn5 转座酶矫正。</p></li></ul><h4 id="scorebigwig-足迹计算" tabindex="-1"><a class="header-anchor" href="#scorebigwig-足迹计算"><span>ScoreBigwig 足迹计算</span></a></h4><ul><li><p>&quot;tobias_ScoreBigwig_case.smk&quot;, &quot;tobias_ScoreBigwig_control.smk&quot;</p><p>使用 <code>TOBIAS</code> 根据校正后的信号文件和合并的 Peaks 计算足迹。</p></li></ul><h4 id="bindetect-分析" tabindex="-1"><a class="header-anchor" href="#bindetect-分析"><span>BINDetect 分析</span></a></h4><ul><li><p>&quot;tobias_BINDetect.smk&quot; 使用 <code>TOBIAS</code> 在 <code>case</code> 组和 <code>control</code> 组的足迹信号文件上进行 <code>BINDetect</code> 分析：首先在所有开发区域搜索已知的 motif 基序，确定可能的结合位点，再结合足迹分数，推测是否可能有 TF 结合。</p><p>详细结果文件 <code>~/myATAC-seq/bindetect/footprinting/bindetect_results.xlsx</code> ( 含有两页：单个 motif 和 motif 簇 ) ，交互式网页 <code>~/myATAC-seq/bindetect/footprinting/bindetect_HCC_Healthy.html</code> 。</p></li></ul><hr><h3 id="_7-2-单个-motif-分析" tabindex="-1"><a class="header-anchor" href="#_7-2-单个-motif-分析"><span>7.2 单个 motif 分析</span></a></h3><ul><li>这里我以 FOXA1 为例，进行单个 motif 分析，直观展示不同条件下的足迹可视化图谱。</li></ul><h4 id="聚合信号曲线图" tabindex="-1"><a class="header-anchor" href="#聚合信号曲线图"><span>聚合信号曲线图</span></a></h4><ul><li>使用 <code>TOBIAS PlotAggregate</code> 绘制。<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect/motif</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/bindetect/motif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotAggregate</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_unbound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HHealthy_unbound</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signals </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../HCC/tobias/HCC_uncorrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_uncorrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signal-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_uncorrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_uncorrected</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--output </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">FOXA1_MA0148.4_PlotAggregate.pdf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--plot-boundaries</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>FOXA1_MA0148.4_PlotAggregate.pdf</strong></p><img src="`+g+`" alt="FOXA1_MA0148.4_PlotHeatmap" style="zoom:10%;"><h4 id="热图" tabindex="-1"><a class="header-anchor" href="#热图"><span>热图</span></a></h4><ul><li>使用 <code>TOBIAS PlotHeatmap</code> 绘制。<div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotHeatmap</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_HCC_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_bound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_Healthy_unbound.bed </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--TFBS-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_unbound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_bound</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HHealthy_unbound</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signals </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../HCC/tobias/HCC_uncorrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../Healthy/tobias/Healthy_uncorrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--signal-labels </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC_uncorrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_corrected</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy_uncorrected</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--output </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">FOXA1_MA0148.4_PlotHeatmap.pdf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--plot_boundaries</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>FOXA1_MA0148.4_PlotHeatmap.pdf</strong></p><img src="`+o+`" alt="FOXA1_MA0148.4_PlotHeatmap" style="zoom:10%;"><h3 id="_7-3-筛选位点" tabindex="-1"><a class="header-anchor" href="#_7-3-筛选位点"><span>7.3 筛选位点</span></a></h3><ul><li><p>我写了个 <code>shell</code> 脚本 <code>filter.sh</code> ，用于筛选前 20 个位点。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 过滤条件 HCC_bound + Healthy_bound == 2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">awk</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -F</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">NR == 1 { next } $12 + $13 == 2 {print $0}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">../footprinting/FOXA1_MA0148.4/FOXA1_MA0148.4_overview.txt </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 按 Healthy_score 降序排序, 并取前 20 行</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sort</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">$&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -k11,11nr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> head</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 20</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成 plot_regions 数据</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">awk</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -F</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    { </span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        plot_start = $8 - 1000;          # $8 是 peak_start</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        plot_end = $9 + 1000;            # $9 是 peak_end</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        print $7, plot_start, plot_end;  # 输出 peak_chr, plot_start, plot_end</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    }</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> OFS=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">plot_regions.bed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 清理中间文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filtered.tmp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top20.tmp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用 <code>TOBIAS PlotTracks</code> 绘制 <code>IGV</code> 风格的全基因组信号轨迹，以观察足迹分布。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">TOBIAS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PlotTracks</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/HCC1/macs3/HCC1_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/HCC2/macs3/HCC2_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/Healthy1/macs3/Healthy1_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../pre_and_peakcalling/Healthy2/macs3/Healthy2_treat_pileup.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/HCC/tobias/HCC_corrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/Healthy/tobias/Healthy_corrected.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/HCC/tobias/HCC_footprints.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--bigwigs </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../bindetect/Healthy/tobias/Healthy_footprints.bw</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--regions </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">plot_regions.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--sites </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_all.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--highlight </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../footprinting/FOXA1_MA0148.4/beds/FOXA1_MA0148.4_all.bed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--gtf </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../data/Homo_sapiens.GRCh38.100.chr.gtf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--colors </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> red</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> darkblue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>总共 20 个位点，这里我选取前三个位点的图来展示。</p><p><strong>4-2260960-2263835.png</strong></p><img src="`+y+'" alt="4-2260960-2263835" style="zoom:20%;"><hr><p><strong>12-114683033-114685961.png</strong></p><img src="'+D+'" alt="12-114683033-114685961" style="zoom:20%;"><hr><p><strong>16-4615067-4617804.png</strong></p><img src="'+C+`" alt="16-4615067-4617804" style="zoom:20%;"></li></ul><h2 id="_8-差异分析" tabindex="-1"><a class="header-anchor" href="#_8-差异分析"><span>8. 差异分析</span></a></h2><h3 id="_8-1-准备工作" tabindex="-1"><a class="header-anchor" href="#_8-1-准备工作"><span>8.1 准备工作</span></a></h3><ul><li><p>构建样本元数据表 ( <code>~/myATAC-seq/data/sheet.csv</code>)：</p><div class="language-csv line-numbers-mode" data-ext="csv" data-title="csv"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">SampleID	Tissue	Factor	Condition	Treatment	Replicate	bamReads	Peaks	PeakCaller</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Healthy1	NA	Healthy_Factor	Healthy_Condition	HCV-	1	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy1/alignmentSieve/ATACshifted_Healthy1_sorted.bam	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy1/macs3/Healthy1_peaks.narrowPeak	bed</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Healthy2	NA	Healthy_Factor	Healthy_Condition	HCV+	2	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy2/alignmentSieve/ATACshifted_Healthy2_sorted.bam	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/Healthy2/macs3/Healthy2_peaks.narrowPeak	bed</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">HCC1	NA	HCC_Factor	HCC_Condition	HCV-	1	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC1/alignmentSieve/ATACshifted_HCC1_sorted.bam	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC1/macs3/HCC1_peaks.narrowPeak	bed</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">HCC2	NA	HCC_Factor	HCC_Condition	HCV+	2	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC2/alignmentSieve/ATACshifted_HCC2_sorted.bam	/public/workspace/stu22230111/myATAC-seq/pre_and_peakcalling/HCC2/macs3/HCC2_peaks.narrowPeak	bed</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_8-2-代码" tabindex="-1"><a class="header-anchor" href="#_8-2-代码"><span>8.2 代码</span></a></h3><ul><li><p>直接 <code>Rscript</code> 运行：</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Rscript</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/R_diffbind/diffbind.R</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>R 代码详情如下：</p><div class="language-r line-numbers-mode" data-ext="r" data-title="r"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(DiffBind)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(tidyverse)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(corrplot)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">library</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(PCAtools)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 新建文件夹</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">output_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">~/myATAC-seq/diffbind</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dir.create</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">recursive</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 切换工作目录</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">setwd</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 加载样本信息</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> read.csv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">~/myATAC-seq/data/sheet.csv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sep</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\t</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sampleSheet</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 构建 DiffBind 对象</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> data.frame</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">doBlacklist</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> doGreylist</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bRemoveM</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bRemoveRandom</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 计算峰值</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">summits</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 200</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 峰宽 = 2 * summits + 1</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bUseSummarizeOverlaps</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 更准，更慢</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">score</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBA_SCORE_RPKM</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 标准化</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.normalize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">normalize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBA_NORM_TMM</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 提取 FPKM 数据</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> diff_bind_obj</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">$</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">binding </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">%&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">as_tibble</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mutate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">peak_id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str_c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">chr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CHR</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> START</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">_</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> END</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">column_to_rownames</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">var</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">peak_id</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> %&gt;%</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">select</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">CHR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">START</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">END</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 绘制相关性热图并保存为 PDF</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">correlation_plot.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">corrplot</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cor</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addCoef.col</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">white</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># PCA 分析</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pca</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pca</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">peaks_fpkm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> metadata</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> column_to_rownames</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sampleSheet</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> var</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">SampleID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 绘制 PCA 二维图并保存为 PDF</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pca_biplot.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">biplot</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(pca, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">colby</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Factor</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 差异分析</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Healthy_Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HCC_Condition</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">minMembers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.analyze</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 差异分析结果展示</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># (这里的韦恩图好像没啥意义...)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># pdf(file = file.path(output_dir, &quot;differential_binding_venn.pdf&quot;))</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dba.plotVenn(diff_bind_obj, contrast = 1, bDB = TRUE, bGain = TRUE, bLoss = TRUE, bAll = FALSE)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dev.off()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 火山图</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pdf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">differential_binding_volcano.pdf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">))</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dba.plotVolcano</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> contrast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dev.off</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 保存差异结果表</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dba.report</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">diff_bind_table</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> as.data.frame</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(diff_bind_result)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">write.csv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(diff_bind_table, </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> file.path</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(output_dir, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">diff_bind_results.csv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">), </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">row.names</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FALSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 打印差异分析对比结果</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">print</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dba.show</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">diff_bind_obj</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> bContrasts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRUE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_8-3-结果" tabindex="-1"><a class="header-anchor" href="#_8-3-结果"><span>8.3 结果</span></a></h3><ul><li><p>三张图。</p><p><strong>correlation_plot.pdf</strong></p><img src="`+u+'" alt="correlation_plot" style="zoom:9%;"><hr><p><strong>pca_biplot.pdf</strong></p><img src="'+B+'" alt="pca_biplot" style="zoom:9%;"><hr><p><strong>differential_binding_volcano.pdf</strong></p><img src="'+m+`" alt="differential_binding_volcano" style="zoom:9%;"></li></ul><hr><ul><li>最后来一张深度为 2 的 <code>tree</code> 作为收尾。</li></ul><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tree</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/myATAC-seq/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -L</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/public/workspace/stu22230111/myATAC-seq/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bindetect</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> footprinting</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> motif</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> peak_merge</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> data</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> blacklist.v2</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> -</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/ENCODE/blacklist.v2/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> BWA_Index</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> -</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/BWA_Index/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Homo_sapiens.GRCh38.100.chr.gtf</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> -</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/Ensembl/Homo_sapiens.GRCh38.100.chr.gtf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> motif_databases</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> -</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /public/workspace/shaojf/Course/NGS/Reference/MEME/motif_databases/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sheet.csv</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849295_1.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849295_2.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849301_1.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849301_2.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849307_1.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849307_2.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849313_1.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SRR13849313_2.fastq.gz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> diffbind</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> correlation_plot.pdf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> diff_bind_results.csv</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> differential_binding_volcano.pdf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pca_biplot.pdf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LICENSE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pre_and_peakcalling</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HCC2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Healthy2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> R_diffbind</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> diffbind.R</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> README.md</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> singularity</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ATAC_seq_pipeline.def</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bin</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> debian.sources</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> env_ATAC_seq.yml</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> env_idr.yml</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│  </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myATAC-seq.sif</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">└──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> snakemake</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    ├──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bindetect</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    └──</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pre_and_peakcalling</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-总结" tabindex="-1"><a class="header-anchor" href="#_9-总结"><span>9. 总结</span></a></h2><h3 id="_9-1-小技巧" tabindex="-1"><a class="header-anchor" href="#_9-1-小技巧"><span>9.1 小技巧</span></a></h3><h4 id="_1-快速查看服务器上的文件" tabindex="-1"><a class="header-anchor" href="#_1-快速查看服务器上的文件"><span>1. 快速查看服务器上的文件</span></a></h4><ul><li><p>想要查看结果文件（PDF、HTML、PNG等），可以先 <code>cd</code> 到相应路径，然后使用 <code>python3</code> 中的 <code>http.server</code> 模块将文件夹临时暴露成类似于 <code>nginx</code> 那样的静态文件服务（ 11111是端口号，可以随便设置，建议范围在 10000 - 60000 之间 ）：</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -m</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http.server</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 11111</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>在本地电脑上的浏览器输入服务器对应的 <code>ip地址:端口</code> ，即可访问：</p><img src="`+v+`" alt="python_httpserver1" style="zoom:60%;"></li></ul><h4 id="_2-pdf-转-png" tabindex="-1"><a class="header-anchor" href="#_2-pdf-转-png"><span>2. <code>pdf</code> 转 <code>png</code></span></a></h4><ul><li><p>使用 <code>magick</code> 软件可以在命令行快速进行常见图片格式的转换操作。可以使用 <code>conda</code> 或 <code>micromamba</code> 进行安装使用。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 假如你用的是 anaconda/miniconda</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">conda</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> conda-forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> imagemagick</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 假如你用的是 micromamba</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">micromamba</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> conda-forge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> imagemagick</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># pdf转png (density是分辨率，ppi)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">magick</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -density</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 300</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> foo.pdf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> foo.png</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_9-2-注意" tabindex="-1"><a class="header-anchor" href="#_9-2-注意"><span>9.2 注意</span></a></h3><ol><li><code>peak_merge</code> 的结果需要手动去除线粒体 DNA ，我使用的是 <code>grep -Ev &#39;(chrM|chrMT|M|MT|Mito)&#39;</code> 。</li><li><code>DiffBind</code> 输入只能为 <code>bam</code> 或 <code>bed</code> 或 <code>bed.gz</code>，<code>alignmentSieve</code> 那步输出不可为 <code>bedpe</code>，而且还需要再次 <code>samtools</code> 排序。</li><li>通过 <code>conda-forge</code> 源安装的 <code>singularity</code> 在某些系统上可能会出现 <code>Failed to create user namespace: user namespace disabled: exit status 1</code> ，可以联系服务器管理员临时调整最大用户命名空间：<code>sudo sysctl user.max_user_namespaces=65536</code>，或永久调整：<code>echo &quot;user.max_user_namespaces=65536&quot; &gt;&gt; /etc/sysctl.conf</code></li><li>使用 <code>Diffbind</code> 中的 <code>dba.count</code> 函数时，中生成的 <code>.bam</code> 文件需要按照参考基因组的位置进行排序，我在 <code>pre_and_peakcalling</code> 的 “偏移修正” 里面已经使用 <code>samtools</code> 排序了。</li></ol><h2 id="_10-参考文献" tabindex="-1"><a class="header-anchor" href="#_10-参考文献"><span>10. 参考文献</span></a></h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>Grandi, F.C., Modi, H., Kampman, L. <em>et al.</em> Chromatin accessibility profiling by ATAC-seq. <em>Nat Protoc</em> <strong>17</strong>, 1518–1552 (2022). https://doi.org/10.1038/s41596-022-00692-9 <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p>Bentsen, M., Goymann, P., Schultheis, H. <em>et al.</em> ATAC-seq footprinting unravels kinetics of transcription factor binding during zygotic genome activation. <em>Nat Commun</em> <strong>11</strong>, 4267 (2020). https://doi.org/10.1038/s41467-020-18035-1 <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li></ol></section>`,49))])}const q=p(b,[["render",_],["__file","index.html.vue"]]),H=JSON.parse(`{"path":"/NGS/2anb5jfk/","title":"Project 01","lang":"zh-CN","frontmatter":{"title":"Project 01","createTime":"2024/10/31 23:39:51","permalink":"/NGS/2anb5jfk/","description":"2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组 基于 Snakemake 的 ATAC-seq 足迹识别与差异分析流程开发及应用：以 HCV 相关肝癌为例 1. 前言 1.1 背景 慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者...","head":[["meta",{"property":"og:url","content":"https://meteor-oxalis3.com/NGS/2anb5jfk/"}],["meta",{"property":"og:site_name","content":"Meteor03's Oxalis Garden"}],["meta",{"property":"og:title","content":"Project 01"}],["meta",{"property":"og:description","content":"2024 秋学期 高通量大作业 | 22230111 郎程闰 表观遗传组 基于 Snakemake 的 ATAC-seq 足迹识别与差异分析流程开发及应用：以 HCV 相关肝癌为例 1. 前言 1.1 背景 慢性丙型肝炎病毒 ( HCV ) 感染是导致肝硬化和肝细胞癌 ( HCC ) 的主要致病因素。在全球范围内，约有 7100 万慢性 HCV 感染者..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://meteor-oxalis3.com/home/saturn/10_Typora/NGS_Project01/ATAC_seq_Data.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Project 01\\",\\"image\\":[\\"https://meteor-oxalis3.com/home/saturn/10_Typora/NGS_Project01/ATAC_seq_Data.png\\",\\"https://meteor-oxalis3.com/home/saturn/10_Typora/NGS_Project01/snakemake_workflow.png\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"1. 前言","slug":"_1-前言","link":"#_1-前言","children":[{"level":3,"title":"1.1 背景","slug":"_1-1-背景","link":"#_1-1-背景","children":[]},{"level":3,"title":"1.2 目标","slug":"_1-2-目标","link":"#_1-2-目标","children":[]}]},{"level":2,"title":"2. 相关网址","slug":"_2-相关网址","link":"#_2-相关网址","children":[]},{"level":2,"title":"3. 数据来源","slug":"_3-数据来源","link":"#_3-数据来源","children":[]},{"level":2,"title":"4. 环境工具","slug":"_4-环境工具","link":"#_4-环境工具","children":[]},{"level":2,"title":"5. 准备工作","slug":"_5-准备工作","link":"#_5-准备工作","children":[{"level":3,"title":"5.1 数据准备","slug":"_5-1-数据准备","link":"#_5-1-数据准备","children":[]},{"level":3,"title":"5.2 环境配置","slug":"_5-2-环境配置","link":"#_5-2-环境配置","children":[]}]},{"level":2,"title":"6. 数据预处理 + Peak Calling","slug":"_6-数据预处理-peak-calling","link":"#_6-数据预处理-peak-calling","children":[{"level":3,"title":"6.1 代码","slug":"_6-1-代码","link":"#_6-1-代码","children":[]}]},{"level":2,"title":"7. 足迹识别","slug":"_7-足迹识别","link":"#_7-足迹识别","children":[{"level":3,"title":"7.1 代码","slug":"_7-1-代码","link":"#_7-1-代码","children":[]},{"level":3,"title":"7.2 单个 motif 分析","slug":"_7-2-单个-motif-分析","link":"#_7-2-单个-motif-分析","children":[]},{"level":3,"title":"7.3 筛选位点","slug":"_7-3-筛选位点","link":"#_7-3-筛选位点","children":[]}]},{"level":2,"title":"8. 差异分析","slug":"_8-差异分析","link":"#_8-差异分析","children":[{"level":3,"title":"8.1 准备工作","slug":"_8-1-准备工作","link":"#_8-1-准备工作","children":[]},{"level":3,"title":"8.2 代码","slug":"_8-2-代码","link":"#_8-2-代码","children":[]},{"level":3,"title":"8.3 结果","slug":"_8-3-结果","link":"#_8-3-结果","children":[]}]},{"level":2,"title":"9. 总结","slug":"_9-总结","link":"#_9-总结","children":[{"level":3,"title":"9.1 小技巧","slug":"_9-1-小技巧","link":"#_9-1-小技巧","children":[]},{"level":3,"title":"9.2 注意","slug":"_9-2-注意","link":"#_9-2-注意","children":[]}]},{"level":2,"title":"10. 参考文献","slug":"_10-参考文献","link":"#_10-参考文献","children":[]}],"readingTime":{"minutes":11.15,"words":3345},"git":{},"autoDesc":true,"filePathRelative":"notes/NGS/Project_01.md"}`);export{q as comp,H as data};
